# S04 - declarations, exceptions, phasers, statements

- [ ] roast/S04-blocks-and-statements/let.t
- [ ] roast/S04-blocks-and-statements/pointy-rw.t
- [ ] roast/S04-blocks-and-statements/pointy.t
  - 7/21 pass (4-7, 13-15). Pointy blocks work in list context. Failures: `-> $x { }` without parens (1), immediately invoked pointy (2-3), block control exceptions (8-9), return from pointy (10-11), `$^a` in pointy (12), .signature (16), YOU_ARE_HERE (17-19). Only 19 reached. Difficulty: Medium
- [ ] roast/S04-blocks-and-statements/temp.t
- [ ] roast/S04-declarations/constant-6.d.t
- [ ] roast/S04-declarations/constant.t
  - 18/72 pass. Panic fixed (UTF-8 boundary in try_meta_op). Failures: sigiled constants (5-6), constant reassignment checks, our/my scoping, hash/array constants, type constraint enforcement. Difficulty: Medium
- [ ] roast/S04-declarations/implicit-parameter.t
- [ ] roast/S04-declarations/multiple.t
  - 3/8 pass (tests 1-3). Failures: `my ($a, $b) = (1, 2)` destructuring works but `my ($a, @b)` with slurpy not supported; `my ($a, *@b)` splat syntax not implemented; `state` declarations not supported. Difficulty: Medium
- [ ] roast/S04-declarations/my-6e.t
- [ ] roast/S04-declarations/our.t
- [ ] roast/S04-declarations/smiley.t
- [ ] roast/S04-declarations/state.t
  - 0/? pass. No test output at all - `state` declarations not implemented. Silently fails/exits. Difficulty: Medium-High (need `state` variable scoping)
- [ ] roast/S04-declarations/will.t
  - `CHECK`/`INIT` phaser parsing now avoids immediate `Unknown call: CHECK` abort.
  - Current status: runs 15/19 tests, with remaining failures in `will` trait behavior and missing full phaser semantics.
- [ ] roast/S04-exception-handlers/catch.t
  - 2/33 pass (1, 5). Only 5 reached; crashes with unhandled "blah" exception. CATCH in sub works, but CATCH in try/closure/do-block doesn't properly suppress exceptions. Difficulty: Medium-High
- [ ] roast/S04-exception-handlers/control.t
- [ ] roast/S04-exception-handlers/top-level.t
- [ ] roast/S04-exceptions/control_across_runloop.t
  - 0/1 pass. Test uses `sub foo($x = last) { $x }` where `last` is used as a default parameter value that should propagate as a control exception to the enclosing `for` loop. Requires X::ControlFlow exception propagation across call boundaries. Difficulty: Medium-High
- [ ] roast/S04-exceptions/exceptions-alternatives.t
  - Still exits with no TAP plan. Likely blocked by incomplete parsing/execution around complex `grammar` + `token value:sym<...>` constructs in this file.
- [ ] roast/S04-exceptions/fail-6e.t
- [ ] roast/S04-exceptions/fail.t
- [ ] roast/S04-exceptions/pending.t
- [ ] roast/S04-phasers/ascending-order.t
- [ ] roast/S04-phasers/begin.t
  - 7/13 pass (3-4, 7-8, 11-13). BEGIN blocks work for basic cases. Failures: BEGIN as expression (1-2), calling outer subs from BEGIN (5-6), parse error after BEGIN (9), try in BEGIN (10). Difficulty: Medium
- [ ] roast/S04-phasers/check.t
- [ ] roast/S04-phasers/descending-order.t
- [x] roast/S04-phasers/end.t
- [ ] roast/S04-phasers/enter-leave.t
- [ ] roast/S04-phasers/exit-in-check.t
- [ ] roast/S04-phasers/first.t
- [ ] roast/S04-phasers/in-eval.t
- [ ] roast/S04-phasers/init.t
- [ ] roast/S04-phasers/in-loop.t
  - 1/21 pass (test 3: LAST does not fire for empty loop). Failures: FIRST/NEXT/LAST trait blocks in for loop (1-2), only 3 tests reached. Difficulty: Medium-High (FIRST/NEXT/LAST phasers in loops)
- [ ] roast/S04-phasers/interpolate.t
- [ ] roast/S04-phasers/keep-undo.t
- [ ] roast/S04-phasers/multiple.t
- [ ] roast/S04-phasers/next.t
- [ ] roast/S04-phasers/pre-post.t
- [ ] roast/S04-phasers/rvalue.t
- [ ] roast/S04-statement-modifiers/for.t
  - 4/31 pass (11, 15, 17, 23). Most postfix-for constructs fail: `$_` not correctly set by for modifier (1-10, 12-14), double statement-modifier for detection (16), anon sub in modifier (19), `$_` assignment (20-21), decontainerization (28). Difficulty: Medium-High
- [ ] roast/S04-statement-modifiers/given.t
  - 2/12 pass (5, 8). `$_` not properly set by given-modifier in most cases (1-4, 6-7, 9-10). Terminator detection (12), thunk interaction (11). Difficulty: Medium
- [ ] roast/S04-statement-modifiers/if.t
  - 5/16 pass (1, 3, 7, 8, 10). Then crashes with `is-deeply expects right`. Failures: post-if as expression return value (2, 4, 6, 9), `is-deeply` not handling all argument forms (11+). Difficulty: Medium
- [ ] roast/S04-statement-modifiers/unless.t
  - 3/10 pass (2, 5, 7). Failures: post-unless return value (1, 3-4, 6), placeholder blocks (8), terminator detection (9), `$_` in blocks (10). Difficulty: Medium
- [x] roast/S04-statement-modifiers/until.t
- [x] roast/S04-statement-modifiers/values_in_bool_context.t
  - 24/24 pass.
- [x] roast/S04-statement-modifiers/while.t
  - 6/6 pass.
- [ ] roast/S04-statement-modifiers/without.t
- [ ] roast/S04-statement-modifiers/with.t
- [x] roast/S04-statement-parsing/hash.t
- [x] roast/S04-statements/do.t
  - 32/32 pass.
- [ ] roast/S04-statements/for-scope.t
  - 3/16 pass (tests 1, 3, 5). Failures: lexical array reset per iteration (2, 4), itemized array in for loop (6-7), `for @a -> $x` argument list (8). Only 8 tests reached. Difficulty: Medium
- [ ] roast/S04-statements/for.t
  - Fatal: `Module not found: MONKEY-TYPING`. Requires `use MONKEY-TYPING` pragma
- [ ] roast/S04-statements/for_with_only_one_item.t
- [ ] roast/S04-statements/gather.t
  - ~3/39 pass. Failures: gathered element count (test 2), `.shift`/`.pop` on gathered list (tests 4-5), nested gather (tests 6-7), take on lists (test 8), dynamic scoping of gather (test 9), gather as statement_prefix (test 11), laziness (test 12), gather with nested while/loop (tests 13-14), decontainerization (test 18)
- [ ] roast/S04-statements/given.t
  - ~22/54 pass. Failures: regex match object in when-clause (test 8), for+given iteration ordering (test 21), given return value (tests 26-29)
- [ ] roast/S04-statements/goto.t
- [ ] roast/S04-statements/if.t
  - ~16/44 pass. Failures: function call without parens in if cond (test 17), `if` without block should error (test 19), `-> $a` binding in if/elsif/else (tests 20-23), condition evaluation order (tests 24-27), if/elsif/else return value as expression (tests 28-34)
- [ ] roast/S04-statements/label.t
- [x] roast/S04-statements/last.t
- [ ] roast/S04-statements/lazy.t
- [ ] roast/S04-statements/leave.t
- [ ] roast/S04-statements/loop.t
  - 11/18 pass. Failures: loop with two variables in init (test 12), `loop {} while` syntax error detection (test 14), gather+take+loop interaction (test 15)
- [x] roast/S04-statements/map-and-sort-in-for.t
- [ ] roast/S04-statements/next.t
  - 7/12 pass (1, 5-9, 12). Failures: `next unless <cond>` (2), `<cond> && next` (3), `<cond> and next` (4), post-next statement execution detection (10-11). Difficulty: Low-Medium
- [ ] roast/S04-statements/no-implicit-block.t
- [ ] roast/S04-statements/once.t
- [ ] roast/S04-statements/quietly.t
- [ ] roast/S04-statements/redo.t
- [ ] roast/S04-statements/repeat.t
  - 8/21 pass (1-8). Only 10 tests reached; crashes at test 10 with `X::ControlFlow`. Basic `repeat {} while/until` works including redo. Failures: unknown issue at test 9-10, rest not reached. Difficulty: Medium
- [ ] roast/S04-statements/return.t
  - 12/26 pass (1, 3, 7-14, 16, 20). Failures: bare return with parens (2), bare return in statement modifiers (4-6), test 15 unknown, proxied return (17-18), `.return` method (19), INIT/CHECK return (21-22), tests 23-26 not reached. Difficulty: Medium
- [ ] roast/S04-statements/sink.t
  - 6/10 pass (11 reached, plan 10). Tests 2-3, 6-8, 10 pass. Failures: .unshift in sink context (1), map in sunk for (4-5), sub in sunk for (9), loop sink (11). Difficulty: Medium
- [ ] roast/S04-statements/terminator.t
  - 9/20 pass (1-7, 10, 15). Good semicolon and statement terminator support. Failures: open closure detection (8), incomplete expression error (9), newline-separated statements (11), auto-curly in array (12), `is()` after postfix modifier (13), space-after-parens (14). Only 15 tests reached. Difficulty: Medium
- [ ] roast/S04-statements/try.t
  - 10/40 pass (1-3, 5, 7, 11, 13-15, 17). Only 21 reached; crashes with custom exception class. Basic try/CATCH works. Failures: array/hash assignment from try (4, 6, 8-10, 12), return in try (16), CATCH edge cases (18-21). Difficulty: Medium
- [x] roast/S04-statements/unless.t
  - 10/10 pass. All tests pass.
- [x] roast/S04-statements/until.t
  - 4/4 pass.
- [ ] roast/S04-statements/when.t
- [ ] roast/S04-statements/while.t
  - 13/31 pass (1-6, 10, 12, 16-17, 19, 22, 24). Failures: `while -> $x` pointy block binding (7-8), keyword whitespace detection (9), return values from while/until/loop (11, 15, 21, 23, 29-31), UNDO phaser in failed blocks (14, 18, 20), while modifier for values (25-28). Difficulty: Medium
- [ ] roast/S04-statements/with.t
